#!/bin/bash
set -e

if [ "$NEXT_PUBLIC_API_URL" = "" ]; then
	export NEXT_PUBLIC_API_URL=$API_URL
fi

# Disabling fund and audit from NodeJS configuration
npm config set fund false -g
npm config set audit false -g

echo 'Installing (clean-install) of all the dependencies'
npm ci --omit=optional

echo 'Building the NextJS application'
npm run build

echo "Exec the container's main process (what's set as CMD in the Dockerfile)."
exec "$@"
